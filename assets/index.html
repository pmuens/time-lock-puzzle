<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="wasm_exec.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css"
    />
    <style>
      div {
        text-align: center;
      }
      div input {
        margin: auto;
        display: block;
        text-align: center;
        margin-bottom: 12px;
      }
      hr {
        margin: 25px 0;
      }
    </style>
    <script>
      const go = new Go();
      WebAssembly.instantiateStreaming(
        fetch("main.wasm"),
        go.importObject
      ).then((result) => {
        go.run(result.instance);
      });
    </script>
  </head>
  <body>
    <div>
      <h1>Time-Lock Puzzle</h1>
      <p>
        <a href="https://github.com/pmuens/time-lock-puzzle" target="_blank"
          >Implementation</a
        >
        of
        <a
          href="https://people.eecs.berkeley.edu/~daw/papers/timelock.pdf"
          target="_blank"
          >Rivest et al. - Time-Lock Puzzles and Timed-Release Crypto</a
        >.
      </p>
      <hr />
      <form>
        <label for="message">Message</label>
        <input
          id="message"
          name="message"
          type="number"
          min="1"
          placeholder="Message"
          value="42"
        />
        <label for="difficulty">Difficulty</label>
        <input
          id="difficulty"
          name="difficulty"
          type="number"
          min="1"
          placeholder="Difficulty"
          value="2"
        />
        <button type="button" name="solve" onclick="tlp()">
          Generate and Solve
        </button>
        <hr />
        <input type="number" disabled name="result" placeholder="Result" />
      </form>
    </div>
  </body>
  <script>
    var tlp = async function (message, difficulty) {
      var message = document.querySelector('input[name="message"]');
      var difficulty = document.querySelector('input[name="difficulty"]');
      var result = document.querySelector('input[name="result"]');
      result.value = runTLP(Number(message.value), Number(difficulty.value));
    };
  </script>
</html>
